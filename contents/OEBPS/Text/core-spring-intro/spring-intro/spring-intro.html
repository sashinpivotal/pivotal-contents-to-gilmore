                <!DOCTYPE html>
<html lang="en">
<head>

<meta name="course version" content="1.8.1">
<meta name="generator" content="io.pivotal.pal.shipkin:shipkin-plugin:8.5.2, https://github.com/platform-acceleration-lab/shipkin">
<meta name="generated on" content="2020-05-23T13:27:08.486Z">
<meta name="theme-color" content="#34302d">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Core Spring - The Rewards Application</title>

<link rel="icon" href="../../theme-images/favicon.png">

<link rel="stylesheet" href="../../css/reset.css">
<link rel="stylesheet" href="../../css/theme.css">
<link rel="stylesheet" href="../../css/highlight.js.min.css">
<link rel="stylesheet" href="../../css/github.css">

<style>
    @import url('https://fonts.googleapis.com/css?family=Varela+Round');

    #header {
        border-color: #6db33f;
        background-color: #34302d;
    }

    .disclaimer {
        background-color: #34302d;
    }

    footer {
        background-color: #34302d;
    }

    .label.label-default {
        background-color: #5fa134;
    }

    a {
        color: #5fa134;
    }

    th {
        background-color: #34302d;
        border-color: #34302d;
    }

    blockquote:before {
        color: #34302d;
    }

    .label.label-default:hover, .label.label-default:focus {
        background-color: #6eb043;
    }

    a:hover, a:focus {
        color: #6eb043;
    }

    .slide {
        color: #34302d;
    }

    .slide h2, .slide label {
        color: #5fa134;
    }

    .slide input {
        color: rgba(52, 48, 45, 0.65);
    }

    .face path {
        fill: #5fa134;
    }

    body {
        background-color: #f1f1f1;
    }

    .slide {
        background-color: rgba(241, 241, 241, 0.9);
    }

    .slide.text {
        background-color: #f1f1f1;
    }

    .slide h2, .slide label {
        color: inherit;
    }

    body {
        color: #34302d;
    }

    td {
        border-color: #34302d;
    }

    html, body {
        font-family: 'Varela Round', sans-serif;
    }

</style>

<link rel="stylesheet" href="../../css/custom.css">
</head>
<body>


<style>
    #spring-logo {
        background: url(../../images/spring-logo.png) -1px -1px no-repeat;
    }
    #spring-logo span {
        background: url(../../images/spring-logo.png) -1px -48px no-repeat;
    }
</style>

<header>
    <div class="container">
        <a id="spring-logo"
           href="../.."><span></span></a>

        <p>
            Customer agrees that the <a rel="noreferrer noopener"
                                        href="https://pivotal.io/svcs-terms">Professional
                Services Terms and Conditions</a>
            and the <a rel="noreferrer noopener"
                       href="https://pivotal.io/training/terms">Education
                And Training Services Terms Of Use</a>
            are incorporated by reference into this Data Sheet and shall
            govern the provision of the Pivotal Services and content
            accessible on from this
            page. Customer may not record or reproduce the training in
            any medium. Customer may not copy, reproduce, or distribute
            or otherwise share the
            training materials in any capacity.
        </p>
    </div>
</header>

<div class="container title">
    <h1>The Rewards Application</h1>
</div>


<a class="feedback" href="https://docs.google.com/forms/d/1EI7PkShHp5FoKHcfYX_eVWJfMtxE-tFTWCPr7H6zodA/viewform" data-url-field="entry.1915922799" target="_blank" rel="noreferrer noopener">
    <button>feedback</button>
</a>

<main id="main">

    <div id="content" class="container">
        <article>
 <h1 id="purpose">Purpose</h1>
<p>Welcome to <em>Core Spring</em>!</p>
<p>In this lab you will come to understand the basic workings of the
<em>Reward Network</em> reference application and you will be introduced to
the tools you will use throughout the course.</p>
<h1 id="learning-outcomes">Learning Outcomes</h1>
<p>What you will learn:</p>
<ol>
<li>Project structure</li>
<li>Core <em>RewardNetwork</em> Domain and API</li>
<li>Basic interaction of the key components within the domain.</li>
</ol>
<p>Specific subjects you will gain experience with:</p>
<ul>
<li>You will see that the application logic will be clean and not
coupled with infrastructure APIs.</li>
<li>You will understand that you can develop and unit test your business
logic without using Spring.</li>
<li>In later labs you will see that the code you develop in this lab will be
directly runnable in a Spring environment without change.</li>
</ul>
<p>You will be using the <em>10-spring-intro</em> project.</p>
<p>Estimated time to complete:
30 minutes.</p>
<h1 id="use-case">Use Case</h1>
<p>Once you will have familarized yourself with the tools and the
application domain, you will implement and test the
<a href="../../course-intro/reference-domain/reference-domain.html" rel="noreferrer noopener">Rewards Application</a>
using Plain Old Java objects (POJOs).</p>
<p>Have fun with the steps below, and remember the goal is to get
comfortable with the tools and application concepts.</p>
<h1 id="instructions">Instructions</h1>
<p>This lab differs from the remainder of the course in that most of the
steps are review tasks.
It is imperative you follow <em>all</em> the review tasks to gain an
understanding of the problem domain, and this existing codebase.
It is the basis of the rest of the course.</p>
<h2 id="review-rewards-domain">Review Rewards Domain</h2>
<ul>
<li>Review the
<a href="../../course-intro/reference-domain/reference-domain.html" rel="noreferrer noopener">Rewards Application</a>
to gain background on the Rewards application.</li>
</ul>
<h2 id="review-project-structure">Review Project Structure</h2>
<ul>
<li>
<p>Open the <em>10-spring-intro</em> project and expand its <em>Referenced
Libraries</em> node.</p>
</li>
<li>
<p>Review the dependencies show in the following diagram:</p>
<p><img src="images/dependencies.png" alt="Referenced Libraries" class="figure" /></p>
<p>For the most part, these dependencies are straightforward and
probably similar to what you're used to in your own projects.
For example, there are several dependencies on Spring Framework
jars, on Hibernate, DOM4J, etc.</p>
</li>
</ul>
<h2 id="review-rewards-common-project">Review Rewards Common Project</h2>
<p>In addition to having dependencies on a number of libraries, all lab
projects also have a dependency on a common project called
<em>00-rewards-common</em>.</p>
<ul>
<li>
<p>Open this project now.</p>
<p><img src="images/rewards-project.png" alt="Rewards Common Project" class="figure" /></p>
<p>This project is specific to Spring Training courseware, and contains
a number of useful types such as <em>MonetaryAmount</em>, <em>SimpleDate</em> and
<em>Percentage</em>.
You will make use of these types throughout the course.</p>
</li>
<li>
<p>Take a moment now to explore the contents of the project.</p>
</li>
</ul>
<h2 id="review-reward-network-application-domain-and-api">Review Reward Network Application Domain and API</h2>
<p>Before we use Spring to configure an application, we need to understand
the application itself.</p>
<p>This section will guide you through the background of the Reward Network
application domain and provide context for the rest of the course.</p>
<p>The rewards application consists of several pieces that work together to
reward accounts for dining at restaurants.</p>
<p>In this lab, most of these pieces have been implemented for you.
However, the central piece, the <code>RewardNetwork</code>, has not.</p>
<h3 id="review-the-rewardnetworkimpl-class">Review the <code>RewardNetworkImpl</code> Class</h3>
<p>The <code>RewardNetwork</code> is responsible for carrying out
<code>rewardAccountFor(Dining)</code> operations.
It is an interface.</p>
<p>It is implemented by the <code>RewardNetworkImpl</code> class:</p>
<p><img src="images/rewardnetwork-classdiagram-basic.png" alt="RewardNetworkImpl implements the RewardNetwork interface" class="figure" /></p>
<ul>
<li>
<p>In the <code>10-spring-intro</code> project, navigate into the <code>src/main/java</code>
source folder and you will see the root <code>rewards</code> package.
Within that package you will find the <code>RewardNetwork</code> Java interface
definition:</p>
<p><img src="images/rewards-package.png" alt="The rewards Package" class="figure" /></p>
<p>The classes inside the root <code>rewards</code> package fully define the public
interface for the application, with <code>RewardNetwork</code> being the central
element.</p>
</li>
<li>
<p>Open the <code>RewardNetwork</code> class and review it.</p>
</li>
<li>
<p>Expand the <code>rewards.internal</code> package and open the implementation
class <code>RewardNetworkImpl</code>.</p>
</li>
</ul>
<h3 id="review-the-rewardnetworkimpl-configuration-logic">Review the <code>RewardNetworkImpl</code> Configuration Logic</h3>
<p><code>RewardNetworkImpl</code> should rely on three supporting data access services
called 'Repositories' to do its job.
These include:</p>
<ol>
<li>
<p>An AccountRepository to load <code>Account</code> objects to make benefit
contributions to.</p>
</li>
<li>
<p>A RestaurantRepository to load <code>Restaurant</code> objects to calculate how
much benefit to reward an account for dining.</p>
</li>
<li>
<p>A RewardRepository to track confirmed reward transactions for
accounting and reporting purposes.</p>
</li>
</ol>
<p>This relationship is shown graphically as follows:</p>
<p><img src="images/rewardnetworkimpl-classdiagram.png" alt="RewardNetworkImpl dependency diagram" class="figure" /></p>
<ul>
<li>Locate the single constructor and notice all three dependencies are
injected when the <code>RewardNetworkImpl</code> is constructed.</li>
</ul>
<h2 id="implement-the-rewardnetworkimpl-application-logic">Implement the <code>RewardNetworkImpl</code> Application Logic</h2>
<ul>
<li>
<p>Review this existing <code>RewardNetworkImpl.rewardAccountFor(Dining)</code>
implementation.
It does not do anything at the moment.</p>
</li>
<li>
<p>Review the following sequence diagram for
<code>RewardNetworkImpl.rewardAccountFor(Dining)</code>:</p>
<p><img src="images/rewardAccountForDining-sequence-color.png" alt="The 
sequence" class="figure" /></p>
<p>You should <em>not</em> need to use operator <code>new</code> in your code.
Everything you need is returned by the methods you use.
The interaction diagram does not show what each call returns,
but most of them return something.</p>
</li>
</ul>
<p><strong>TODO-01</strong>: Reward an account per the sequence diagram</p>
<ul>
<li>
<p>Implement the application logic necessary to complete the
<code>rewardAccountFor(Dining)</code> operation, delegating to your dependencies
as you go.</p>
</li>
<li>
<p>Get the credit card and merchant numbers from the <code>Dining</code>
object.</p>
</li>
</ul>
<p><strong>TODO-02</strong>: Return the corresponding reward confirmation</p>
<ul>
<li>Set the return value of the <code>rewardAccountFor(Dining)</code> operation to
the <code>RewardConfirmation</code> returned by
<code>RewardRepository.confirmReward()</code> operation.</li>
</ul>
<h2 id="unit-test-the-rewardnetworkimpl-application-logic">Unit Test the <code>RewardNetworkImpl</code> Application Logic</h2>
<p>How do you know the application logic you just wrote actually works?
You do not, not without a test that proves it.
In this step you will review and run an automated JUnit test to verify
what you just coded is correct.</p>
<ul>
<li>
<p>Navigate into the <code>src/test/java</code> source folder and you will see the
root <code>rewards</code> package.</p>
<p>All tests for the rewards application reside within this tree at the
same level as the source they exercise.</p>
</li>
<li>
<p>Drill down into the <code>rewards.internal</code> package and you will see
<code>RewardNetworkImplTests</code>, the JUnit test for your <code>RewardNetworkImpl</code>
class.</p>
<p><img src="images/test-tree.png" alt="Rewards Test Tree" class="figure" /></p>
</li>
<li>
<p>Review the <code>setUp()</code> method, the 'stub' repositories have been
created and injected into the <code>RewardNetworkImpl</code> class using the
constructor.</p>
</li>
</ul>
<p><strong>TODO-03</strong>: Enable the <code>testRewardForDining()</code> test</p>
<ul>
<li>
<p>Review <code>testRewardForDining()</code> method.
It is the only test method in the <code>RewardNetworkImplTests</code>.
It is initially disabled.</p>
<p>It calls <code>rewardNetwork.rewardAccountFor(Dining)</code> and then makes
assert statements to evaluate the result of calling this method.
In this way the unit test is able to construct an instance of
<code>RewardNetworkImpl</code> using the stub objects as dependencies and
verify that the logic you implemented functions as expected.</p>
</li>
<li>
<p>Enable <code>testRewardForDining()</code> by removing the <code>@Disabled</code>
annotation.</p>
</li>
<li>
<p>Run the <code>RewardNetworkImplTests</code> test from your IDE.</p>
</li>
<li>
<p>You should have successful test.
If you do not, review your
<code>RewardNetworkImpl.rewardAccountFor(Dining)</code> implementation, or your
test <code>setUp()</code> method.</p>
</li>
</ul>
<h1 id="summary">Summary</h1>
<p>You have just developed and unit tested a component of a realistic Java
application, exercising application behavior successfully in a test
environment. You used stubs to test your application
logic in isolation, without involving external dependencies such as a
database or Spring.
And your application logic is clean and decoupled
from infrastructure APIs.</p>
<p>In the next lab, you will use Spring to configure this same application
from all the <em>real</em> parts, including plugging in <em>real</em> repository
implementations that access a relational database.</p>
         </article>
        <div class="sidebar-container">
<nav id="sidebar">
    <div class="title">
        <a href="../../index.html">Return to Core Spring</a>
    </div>
    <div class="content">
        <a href="#">Back to top</a>

<ul>
        <li>
        <a href="#purpose">Purpose</a>

        </li>
        <li>
        <a href="#learning-outcomes">Learning Outcomes</a>

        </li>
        <li>
        <a href="#use-case">Use Case</a>

        </li>
        <li>
        <a href="#instructions">Instructions</a>

<ul>
        <li>
        <a href="#review-rewards-domain">Review Rewards Domain</a>

        </li>
        <li>
        <a href="#review-project-structure">Review Project Structure</a>

        </li>
        <li>
        <a href="#review-rewards-common-project">Review Rewards Common Project</a>

        </li>
        <li>
        <a href="#review-reward-network-application-domain-and-api">Review Reward Network Application Domain and API</a>

<ul>
        <li>
        <a href="#review-the-rewardnetworkimpl-class">Review the RewardNetworkImpl Class</a>

        </li>
        <li>
        <a href="#review-the-rewardnetworkimpl-configuration-logic">Review the RewardNetworkImpl Configuration Logic</a>

        </li>
</ul>
        </li>
        <li>
        <a href="#implement-the-rewardnetworkimpl-application-logic">Implement the RewardNetworkImpl Application Logic</a>

        </li>
        <li>
        <a href="#unit-test-the-rewardnetworkimpl-application-logic">Unit Test the RewardNetworkImpl Application Logic</a>

        </li>
</ul>
        </li>
        <li>
        <a href="#summary">Summary</a>

        </li>
</ul>
    </div>
</nav>
        </div>
    </div>
</main>


<div class="slide" data-slide="1">
    <h1>The Rewards Application</h1>
</div>

<div class="slide transparent" data-slide="2">
    <h1>Get started!</h1>
    <h2>The Rewards Application</h2>
</div>

<div class="slide" data-slide="3">
    <h1>Wrap up</h1>

    <div class="faces">
        <svg class="face" viewBox="0 0 24 24">
            <path d="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M13,9.94L14.06,11L15.12,9.94L16.18,11L17.24,9.94L15.12,7.82L13,9.94M8.88,9.94L9.94,11L11,9.94L8.88,7.82L6.76,9.94L7.82,11L8.88,9.94M12,17.5C14.33,17.5 16.31,16.04 17.11,14H6.89C7.69,16.04 9.67,17.5 12,17.5Z"/>
        </svg>

        <svg class="face" viewBox="0 0 24 24">
            <path d="M8.5,11A1.5,1.5 0 0,1 7,9.5A1.5,1.5 0 0,1 8.5,8A1.5,1.5 0 0,1 10,9.5A1.5,1.5 0 0,1 8.5,11M15.5,11A1.5,1.5 0 0,1 14,9.5A1.5,1.5 0 0,1 15.5,8A1.5,1.5 0 0,1 17,9.5A1.5,1.5 0 0,1 15.5,11M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M9,14H15A1,1 0 0,1 16,15A1,1 0 0,1 15,16H9A1,1 0 0,1 8,15A1,1 0 0,1 9,14Z"/>
        </svg>

        <svg class="face" viewBox="0 0 24 24">
            <path d="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M16.18,7.76L15.12,8.82L14.06,7.76L13,8.82L14.06,9.88L13,10.94L14.06,12L15.12,10.94L16.18,12L17.24,10.94L16.18,9.88L17.24,8.82L16.18,7.76M7.82,12L8.88,10.94L9.94,12L11,10.94L9.94,9.88L11,8.82L9.94,7.76L8.88,8.82L7.82,7.76L6.76,8.82L7.82,9.88L6.76,10.94L7.82,12M12,14C9.67,14 7.69,15.46 6.89,17.5H17.11C16.31,15.46 14.33,14 12,14Z"/>
        </svg>
    </div>
</div>


<div class="slide lemon-squeezy" data-slide="7">
    <h1>Easy peasy</h1>
    <h1>lemon squeezy!</h1>
</div>

<div class="slide" data-slide="8">
    <h1>Lunch time!</h1>
    <label for="lunch-end">will return</label>
    <input type="text" name="lunch-end" data-time="90">
</div>

<div class="slide" data-slide="9">
    <h1>Break time!</h1>
    <label for="break-end">will return</label>
    <input type="text" name="break-end" data-time="15">
</div>

<audio src="../../audio/gong.mp3"
       id="gong"
       preload>
</audio>

<div class="slide" data-slide="?">
    <h2>Keyboard shortcuts</h2>
    <table>
        <thead>
        <tr>
            <th>Key</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>1</td>
            <td>Show <em>introduction</em> slide</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Show <em>get started</em> slide</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Show <em>wrap up</em> slide</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Show <em>instructor notes</em></td>
        </tr>
        <tr>
            <td>7</td>
            <td>Easy peasy</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Show <em>lunch time</em> slide</td>
        </tr>
        <tr>
            <td>9</td>
            <td>Show <em>break time</em> slide</td>
        </tr>
        <tr>
            <td>0</td>
            <td>Play gong sound</td>
        </tr>
        <tr>
            <td>x</td>
            <td>Close slide</td>
        </tr>
        <tr>
            <td>?</td>
            <td>Show this help message</td>
        </tr>
        </tbody>
    </table>
</div>

<footer>
    <div>
        © Copyright 2020 Pivotal Software, Inc. All Rights Reserved. •
        <a href="https://pivotal.io/privacy-policy" rel="noreferrer noopener">Privacy Policy</a> •
        <a href="https://pivotal.io/legal" rel="noreferrer noopener">Terms of Use</a>
    </div>
    <div>
        <label class="hidden-checkbox">
            <input type="checkbox" id="instructor-mode">
            <span>course version: 1.8.1<sup class="check">IM</sup></span>
        </label>
    </div>
</footer>

<script src="../../js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="../../js/assignmentSubmission.js"></script>
<script src="../../js/shipkin.js"></script>
<script src="../../js/slides.js"></script>

</body>
</html>

