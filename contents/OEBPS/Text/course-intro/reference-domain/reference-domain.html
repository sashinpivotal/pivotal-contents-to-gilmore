                <!DOCTYPE html>
<html lang="en">
<head>

<meta name="course version" content="1.8.1">
<meta name="generator" content="io.pivotal.pal.shipkin:shipkin-plugin:8.5.2, https://github.com/platform-acceleration-lab/shipkin">
<meta name="generated on" content="2020-05-23T13:27:08.510Z">
<meta name="theme-color" content="#34302d">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Core Spring - Reward Dining: The Course Reference Domain</title>

<link rel="icon" href="../../theme-images/favicon.png">

<link rel="stylesheet" href="../../css/reset.css">
<link rel="stylesheet" href="../../css/theme.css">
<link rel="stylesheet" href="../../css/highlight.js.min.css">
<link rel="stylesheet" href="../../css/github.css">

<style>
    @import url('https://fonts.googleapis.com/css?family=Varela+Round');

    #header {
        border-color: #6db33f;
        background-color: #34302d;
    }

    .disclaimer {
        background-color: #34302d;
    }

    footer {
        background-color: #34302d;
    }

    .label.label-default {
        background-color: #5fa134;
    }

    a {
        color: #5fa134;
    }

    th {
        background-color: #34302d;
        border-color: #34302d;
    }

    blockquote:before {
        color: #34302d;
    }

    .label.label-default:hover, .label.label-default:focus {
        background-color: #6eb043;
    }

    a:hover, a:focus {
        color: #6eb043;
    }

    .slide {
        color: #34302d;
    }

    .slide h2, .slide label {
        color: #5fa134;
    }

    .slide input {
        color: rgba(52, 48, 45, 0.65);
    }

    .face path {
        fill: #5fa134;
    }

    body {
        background-color: #f1f1f1;
    }

    .slide {
        background-color: rgba(241, 241, 241, 0.9);
    }

    .slide.text {
        background-color: #f1f1f1;
    }

    .slide h2, .slide label {
        color: inherit;
    }

    body {
        color: #34302d;
    }

    td {
        border-color: #34302d;
    }

    html, body {
        font-family: 'Varela Round', sans-serif;
    }

</style>

<link rel="stylesheet" href="../../css/custom.css">
</head>
<body>


<style>
    #spring-logo {
        background: url(../../images/spring-logo.png) -1px -1px no-repeat;
    }
    #spring-logo span {
        background: url(../../images/spring-logo.png) -1px -48px no-repeat;
    }
</style>

<header>
    <div class="container">
        <a id="spring-logo"
           href="../.."><span></span></a>

        <p>
            Customer agrees that the <a rel="noreferrer noopener"
                                        href="https://pivotal.io/svcs-terms">Professional
                Services Terms and Conditions</a>
            and the <a rel="noreferrer noopener"
                       href="https://pivotal.io/training/terms">Education
                And Training Services Terms Of Use</a>
            are incorporated by reference into this Data Sheet and shall
            govern the provision of the Pivotal Services and content
            accessible on from this
            page. Customer may not record or reproduce the training in
            any medium. Customer may not copy, reproduce, or distribute
            or otherwise share the
            training materials in any capacity.
        </p>
    </div>
</header>

<div class="container title">
    <h1>Reward Dining: The Course Reference Domain</h1>
</div>


<a class="feedback" href="https://docs.google.com/forms/d/1EI7PkShHp5FoKHcfYX_eVWJfMtxE-tFTWCPr7H6zodA/viewform" data-url-field="entry.1915922799" target="_blank" rel="noreferrer noopener">
    <button>feedback</button>
</a>

<main id="main">

    <div id="content" class="container">
        <article>
 <h1 id="purpose">Purpose</h1>
<p>The labs in this course teach key concepts in the context of a problem
domain.
The <em>Reward Dining</em> application provides a real-world context for applying
the techniques you have learned to develop useful business applications.</p>
<p>This section provides an overview of the domain and the applications you
will be working on within it.</p>
<h1 id="domain-overview">Domain Overview</h1>
<p>The Domain is called <em>Reward Dining</em>. The idea is that customers
can save money every time they eat at one of the restaurants
participating in the network - a &quot;<em>Frequent Flyer</em>&quot; program for restaurants.</p>
<p>For example, Keith would like to save money for his children's education.
Every time he dines at a restaurant participating in the network, a
contribution is made to his account.</p>
<p><img src="images/keith-dining.png" alt="Papa Keith dines at a restaurant in the Reward
Network" class="figure" /></p>
<p><strong>Figure 1: Papa Keith dines at a restaurant in the Reward
Network</strong></p>
<p>The account contribution (reward) will be shared by his two children Annabelle and Corgan.
Thus Annabelle gets a fund to help her with her college fees:</p>
<p><img src="images/annabelle.png" alt="A percentage of his dining amount goes to daughter Annabelle's college
savings" class="figure" /></p>
<p><strong>Figure 2: Daughter Annabelle gets Contributions to her College Fund</strong></p>
<h1 id="reward-dining-domain-applications">Reward Dining Domain Applications</h1>
<p>This next section provides an overview of the applications in the Reward
Dining domain that you will be working on in this course.</p>
<h2 id="the-rewards-application">The Rewards Application</h2>
<p>The &quot;rewards&quot; application rewards an account for dining at a restaurant
participating in the reward network.
A reward takes the form of a monetary contribution to an account that is
distributed among the account's beneficiaries.
Here is how this application is used:</p>
<ol>
<li>
<p>When they are hungry, members dine at participating restaurants
using their regular credit cards.</p>
</li>
<li>
<p>Every two weeks, a file containing the dining credit card
transactions made by members during that period is generated.
A sample of one of these files is shown below:</p>
<pre><code>AMOUNT    CREDIT_CARD_NUMBER    MERCHANT_NUMBER    DATE
----------------------------------------------------------
100.00  1234123412341234    1234567890      12/29/2010
49.67   1234123412341234    0234567891      12/31/2010
100.00  1234123412341234    1234567890      01/01/2010
27.60   2345234523452345    3456789012      01/02/2010
</code></pre>
<p><strong>Figure 3: Example Dining Records</strong></p>
</li>
<li>
<p>A standalone <code>DiningBatchProcessor</code> application reads this file and
submits each Dining record to the rewards application for
processing.</p>
</li>
</ol>
<h2 id="public-application-interface">Public Application Interface</h2>
<p>The <code>RewardNetwork</code> is the central interface clients such as the
<code>DiningBatchProcessor</code> use to invoke the application:</p>
<pre><code class="language-java">    public interface RewardNetwork {
        RewardConfirmation rewardAccountFor(Dining dining);
    }
</code></pre>
<p><strong>Figure 4: The <code>RewardNetwork</code> Service</strong></p>
<p>It is the only <em>service-layer</em> component in the application.</p>
<p>A <code>RewardNetwork</code> rewards an account for dining by making a monetary
contribution to the account that is in turn distributed among the
account's beneficiaries.
The sequence diagram below shows a client's interaction with the
application illustrating this process:</p>
<p><img src="images/rewards-application.png" alt="A client calling the RewardNetwork to reward an account for
dining." class="figure" /></p>
<p><strong>Figure 5: A client calling the RewardNetwork to reward an account for
dining</strong></p>
<p>In this example, the account with credit card <em>1234123412341234</em> is
rewarded for a spending <em>$100.00</em> at a restaurant with Merchant ID
<em>1234567890</em> on 29th December 2018 (date is in North American date
format).</p>
<p>The confirmed reward, number 9831, takes the form of an <em>$8.00</em>
account contribution distributed evenly among beneficiaries Annabelle
and her brother Corgan.</p>
<h2 id="internal-application-implementation">Internal Application Implementation</h2>
<p>Internally, the <code>RewardNetwork</code> implementation delegates to domain objects
to carry out a <code>rewardAccountFor(Dining)</code> transaction.
Classes exist for the two central domain concepts of the application:
<code>Account</code> and <code>Restaurant</code>.</p>
<ul>
<li>A <code>Restaurant</code> is responsible for calculating the benefit eligible
to an account for a dining.</li>
<li>An <code>Account</code> is responsible for distributing the benefit among
its beneficiaries as a &quot;contribution&quot;.</li>
</ul>
<p>This flow is shown below:</p>
<p><img src="images/rewardnetwork-domainobject-interaction.png" alt="Objects working together to carry out the  use
case." class="figure" /></p>
<p><strong>Figure 6: Objects working together to carry out the <code>rewardAccountFor(Dining)</code> use
case</strong></p>
<p>The <code>RewardNetwork</code> asks the <code>Restaurant</code> to calculate how much benefit to
award, then contributes that amount to the <code>Account</code>.</p>
<p>For convenience the <code>rewards-common</code> project contains a number of
helper classes:</p>
<ul>
<li><code>MonetaryAmount</code> wraps a <code>BigDecimal</code> and holds an amount to 2
decimal places.</li>
<li><code>Percentage</code> wraps a <code>BigDecimal</code> and holds a percentage to 2
decimal places.</li>
</ul>
<h2 id="supporting-reward-network-components">Supporting Reward Network Components</h2>
<p>Account and restaurant information are stored in a persistent form
inside a relational database.
The <code>RewardNetwork</code> implementation delegates to supporting data access
components called 'Repositories' to load <code>Account</code> and <code>Restaurant</code>
objects from their relational representations.</p>
<ul>
<li>An <code>AccountRepository</code> is used to find an <code>Account</code> by its credit
card number</li>
<li>A <code>RestaurantRepository</code> is used to find a <code>Restaurant</code> by its
merchant number.</li>
<li>A <code>RewardRepository</code> is used to track confirmed reward transactions
for accounting purposes.
It holds the same data as the <code>RewardConfirmation</code> in the diagram
(Figure 5) above.</li>
</ul>
<p>A <code>Dining</code> record contains:</p>
<ul>
<li>Customer's credit-card number</li>
<li>Merchant id of the restaurant</li>
<li>Amount paid for the meal</li>
<li>Date the customer dined (unused in our simple implementation)</li>
</ul>
<p>The full <code>rewardAccountFor(Dining)</code> sequence incorporating these
repositories is:</p>
<ul>
<li>Fetch the <code>Account</code> from the <code>AccountRepository</code></li>
<li>Fetch the <code>Restaurant</code> from  <code>RestaurantRepository</code></li>
<li>Determine the Reward contribution (an instance of <code>MonetaryAmount</code>)
using <code>Restaurant.calculateBenefitFor(Account, Dining)</code></li>
<li>Update the account beneficiaries using
<code>Account.makeContribution(MonetaryAmount)</code></li>
<li>Save modified Account information using
<code>AccountRepository.updateBeneficiaries(Account)</code></li>
<li>Create a <code>RewardConfirmation</code> using the <code>RewardRepository</code></li>
</ul>
<h1 id="reward-dining-database-schema">Reward Dining Database Schema</h1>
<p>The Reward Dining applications use a database with this schema:</p>
<p><img src="images/rewardDining-databaseSchema.png" alt="The Reward Dining database
schema" class="figure" /></p>
<p><strong>Figure 7: The Reward Dining database Schema</strong></p>
<p>In most of the labs, a test database is provided for you.
It is populated with test data by running scripts in
<code>00-rewards-common/src/main/resources/rewards/testdb</code>.
They are available as classpath resources.</p>
<p>There are two scripts:</p>
<ul>
<li><code>schema.sql</code> - creates the necessary tables, and</li>
<li><code>data.sql</code> - adds test data (several accounts and a single restaurant)</li>
</ul>
         </article>
        <div class="sidebar-container">
<nav id="sidebar">
    <div class="title">
        <a href="../../index.html">Return to Core Spring</a>
    </div>
    <div class="content">
        <a href="#">Back to top</a>

<ul>
        <li>
        <a href="#purpose">Purpose</a>

        </li>
        <li>
        <a href="#domain-overview">Domain Overview</a>

        </li>
        <li>
        <a href="#reward-dining-domain-applications">Reward Dining Domain Applications</a>

<ul>
        <li>
        <a href="#the-rewards-application">The Rewards Application</a>

        </li>
        <li>
        <a href="#public-application-interface">Public Application Interface</a>

        </li>
        <li>
        <a href="#internal-application-implementation">Internal Application Implementation</a>

        </li>
        <li>
        <a href="#supporting-reward-network-components">Supporting Reward Network Components</a>

        </li>
</ul>
        </li>
        <li>
        <a href="#reward-dining-database-schema">Reward Dining Database Schema</a>

        </li>
</ul>
    </div>
</nav>
        </div>
    </div>
</main>


<div class="slide" data-slide="1">
    <h1>Reward Dining: The Course Reference Domain</h1>
</div>

<div class="slide transparent" data-slide="2">
    <h1>Get started!</h1>
    <h2>Reward Dining: The Course Reference Domain</h2>
</div>

<div class="slide" data-slide="3">
    <h1>Wrap up</h1>

    <div class="faces">
        <svg class="face" viewBox="0 0 24 24">
            <path d="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M13,9.94L14.06,11L15.12,9.94L16.18,11L17.24,9.94L15.12,7.82L13,9.94M8.88,9.94L9.94,11L11,9.94L8.88,7.82L6.76,9.94L7.82,11L8.88,9.94M12,17.5C14.33,17.5 16.31,16.04 17.11,14H6.89C7.69,16.04 9.67,17.5 12,17.5Z"/>
        </svg>

        <svg class="face" viewBox="0 0 24 24">
            <path d="M8.5,11A1.5,1.5 0 0,1 7,9.5A1.5,1.5 0 0,1 8.5,8A1.5,1.5 0 0,1 10,9.5A1.5,1.5 0 0,1 8.5,11M15.5,11A1.5,1.5 0 0,1 14,9.5A1.5,1.5 0 0,1 15.5,8A1.5,1.5 0 0,1 17,9.5A1.5,1.5 0 0,1 15.5,11M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M9,14H15A1,1 0 0,1 16,15A1,1 0 0,1 15,16H9A1,1 0 0,1 8,15A1,1 0 0,1 9,14Z"/>
        </svg>

        <svg class="face" viewBox="0 0 24 24">
            <path d="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M16.18,7.76L15.12,8.82L14.06,7.76L13,8.82L14.06,9.88L13,10.94L14.06,12L15.12,10.94L16.18,12L17.24,10.94L16.18,9.88L17.24,8.82L16.18,7.76M7.82,12L8.88,10.94L9.94,12L11,10.94L9.94,9.88L11,8.82L9.94,7.76L8.88,8.82L7.82,7.76L6.76,8.82L7.82,9.88L6.76,10.94L7.82,12M12,14C9.67,14 7.69,15.46 6.89,17.5H17.11C16.31,15.46 14.33,14 12,14Z"/>
        </svg>
    </div>
</div>


<div class="slide lemon-squeezy" data-slide="7">
    <h1>Easy peasy</h1>
    <h1>lemon squeezy!</h1>
</div>

<div class="slide" data-slide="8">
    <h1>Lunch time!</h1>
    <label for="lunch-end">will return</label>
    <input type="text" name="lunch-end" data-time="90">
</div>

<div class="slide" data-slide="9">
    <h1>Break time!</h1>
    <label for="break-end">will return</label>
    <input type="text" name="break-end" data-time="15">
</div>

<audio src="../../audio/gong.mp3"
       id="gong"
       preload>
</audio>

<div class="slide" data-slide="?">
    <h2>Keyboard shortcuts</h2>
    <table>
        <thead>
        <tr>
            <th>Key</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>1</td>
            <td>Show <em>introduction</em> slide</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Show <em>get started</em> slide</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Show <em>wrap up</em> slide</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Show <em>instructor notes</em></td>
        </tr>
        <tr>
            <td>7</td>
            <td>Easy peasy</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Show <em>lunch time</em> slide</td>
        </tr>
        <tr>
            <td>9</td>
            <td>Show <em>break time</em> slide</td>
        </tr>
        <tr>
            <td>0</td>
            <td>Play gong sound</td>
        </tr>
        <tr>
            <td>x</td>
            <td>Close slide</td>
        </tr>
        <tr>
            <td>?</td>
            <td>Show this help message</td>
        </tr>
        </tbody>
    </table>
</div>

<footer>
    <div>
        © Copyright 2020 Pivotal Software, Inc. All Rights Reserved. •
        <a href="https://pivotal.io/privacy-policy" rel="noreferrer noopener">Privacy Policy</a> •
        <a href="https://pivotal.io/legal" rel="noreferrer noopener">Terms of Use</a>
    </div>
    <div>
        <label class="hidden-checkbox">
            <input type="checkbox" id="instructor-mode">
            <span>course version: 1.8.1<sup class="check">IM</sup></span>
        </label>
    </div>
</footer>

<script src="../../js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="../../js/assignmentSubmission.js"></script>
<script src="../../js/shipkin.js"></script>
<script src="../../js/slides.js"></script>

</body>
</html>

